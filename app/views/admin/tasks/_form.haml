- unless task.new_record? 
  = button_to "Delete", admin_demo_task_path(task.demo, task), :method => :delete, :confirm => "Delete?"
 

- form_submit_path = task.new_record? ? admin_demo_tasks_path(task.demo) : admin_demo_task_path(task.demo, task) 

= semantic_form_for task, :url => form_submit_path do |f| 
  = f.input :identifier 
  = f.input :name 
  = f.input :short_description, :as => :text 
  = f.input :long_description, :as => :text 
  = f.input :bonus_points 
  = f.input :prerequisite_tasks, :collection => @existing_tasks 
  #start_and_end_times
    #start_time
      = f.input :start_time, :twelve_hour => true, :start_year => Time.now.year 
    
    #end_time
      = f.input :end_time, :twelve_hour => true, :start_year => Time.now.year 
    
    .clear
  
  %fieldset
    %legend 
      Completion Triggers
      %p If you don't select any completion triggers, the only way for one to get completed for a user will be for an admin to do so manually.
      %fieldset
        = label_tag "completion[rule_ids]", "Rules" 
        - rule_options = options_from_collection_for_select(@primary_values, :rule_id, :value, :selected => @selected_rule_ids) 
        = select_tag "completion[rule_ids]", rule_options, :multiple => true
        %br

        = label_tag "completion[referrer_required]", "Referrer required" 
        = check_box_tag "completion[referrer_required]", '1', @referrer_required 

      %fieldset
        = label_tag "completion[survey_id]", "Survey" 
        - survey_options = options_from_collection_for_select(@surveys, :id, :name, :selected => @selected_survey_id) 
        = select_tag "completion[survey_id]", survey_options, :include_blank => true 

      %fieldset
        = label_tag "completion[demographics]", "Complete by filling in all demographics" 
        = check_box_tag "completion[demographics]", '1', @complete_by_demographic 

  = f.submit 
  

 

