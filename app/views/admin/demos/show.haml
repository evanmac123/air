.admin
  .breadcrumb
    = link_to "Admin", admin_path
    Â»
    = @demo.name


  = button_to "Send activity dump to Vlad", admin_demo_send_activity_dump_path(@demo.id) 

  %h2 Reports
  %ul 
    %li= link_to "Points", admin_demo_reports_points_path(@demo) 
    %li= link_to "Levels", admin_demo_reports_levels_path(@demo) 
    %li= link_to "Interactions", admin_demo_reports_interactions_path(@demo) 
    %li= link_to "Friendships", admin_demo_reports_friendships_path(@demo)
  %h2
    = @claimed_user_count  
    users have accepted invitations 
    = link_to '(send them a blast SMS)', new_admin_demo_blast_sms_path(@demo) 
  %h2
    = @user_with_mobile_count  
    users have added mobile numbers to their accounts
  %h2
    = @user_with_game_referrer_count
    users have credited a game referrer

  %ul
    %li= link_to "Rules for this demo", admin_demo_rules_path(@demo) 

    %li= link_to "Bad words for this demo", admin_demo_bad_words_path(@demo) 

    %li= link_to "Locations for this demo", admin_demo_locations_path(@demo) 

    %li= link_to "Characteristics for this demo", admin_demo_characteristics_path(@demo)

    %li= link_to "Segment users", admin_demo_segmentation_path(@demo)

    %li= link_to "Send targeted messages to users in this demo", admin_demo_targeted_messages_path(@demo)
    %li= link_to "Conduct raffle", admin_demo_raffles_path(@demo)

  %h2 Settings
  %ul
    %li= link_to "Edit basic settings for this game", edit_admin_demo_path(@demo)

  %p
    - if @demo.client_name.present?
      = "Client name is #{@demo.client_name}"
    - else
      No client name set

  %p
    Game
    - if @demo.begins_at 
      begins at
      = @demo.begins_at.pretty 
    - else 
      began immediately upon creation


  %p
    Game
    - if @demo.ends_at 
      ends at 
      = @demo.ends_at.pretty 
    - else 
      goes on indefinitely.
   


  - if @demo.victory_threshold 
    %p
      = @demo.victory_threshold  
      points to win.
 

  - if @demo.victory_verification_email 
    %p
      Victory email to 
      = @demo.victory_verification_email 
 

  - if @demo.victory_verification_sms_number 
    %p 
      Victory verification SMS to 
      = @demo.victory_verification_sms_number 
 

  %p
    New players start with 
    = @demo.seed_points  
    points.

  - if @levels.empty? 
    %p No levels.
  - else 
    %p Levels:
    %ul
      - @levels.each do |level| 
        %li
          %strong= "#{level.index_within_demo}:" 
          
          = level.name  
          at 
          = level.threshold  
          points
          = link_to '(edit level)', edit_admin_level_path(level.id) 
          = button_to 'Delete level', admin_level_path(level), :method => :delete, :confirm => "Really delete this level (#{level.name})?" 
      
  %ul
    %li= link_to 'Add level', new_admin_demo_level_path(@demo) 

    %li= link_to "Goals for this demo", admin_demo_goals_path(@demo) 

    %li= link_to "Tasks for this demo", admin_demo_tasks_path(@demo) 

  %p
    Welcome message: 
    = @demo.welcome_message 

  %p
    Victory achievement message: 
    = @demo.victory_achievement_message 

  %p
    Victory SMS: 
    = @demo.victory_sms 

  %p
    Victory scoreboard message: 
    = @demo.victory_scoreboard_message 

  %p
    - if @demo.followup_welcome_message.present? 
      Followup welcome message: 
      = @demo.followup_welcome_message  
      (send 
      = @demo.followup_welcome_message_delay
      minutes after invitation accepted)
    - else 
      No followup message.

  %p
    - if @demo.credit_game_referrer_threshold && @demo.game_referrer_bonus 
      Bonus for referring another user to the game: 
      = @demo.game_referrer_bonus  
      points (with a 
      = @demo.credit_game_referrer_threshold  
      minute threshold)
    - else 
      No bonus for referring another user to the game.
   


  %p
    - if @demo.referred_credit_bonus 
      Bonus for crediting the user who referred you to the game: 
      = @demo.referred_credit_bonus  
      points
    - else 
      No bonus for crediting the user who referred you to the game
   


  %p
    - if @demo.points_for_connecting 
      Points for connecting to another user: 
      = @demo.points_for_connecting 
    - else 
      No points for connecting to another user.
   


  %p
    - if @demo.use_standard_playbook 
      Game will use standard playbook rules as well as custom rules.
    - else 
      Game will not use standard playbook rules, only custom rules.
   


  %p
    - if @demo.prize.present? 
      = "Prize response is \"#{@demo.prize}\""
    - else 
      Game will have default response about prizes (indicating no prize)  
   


  %p
    - if @demo.help_message.present? 
      = "Help message is \"#{@demo.help_message}\"" 
    - else 
      Game will have default help message
   
  
  
  %p
    - if @demo.unrecognized_user_message.present? 
      = "Phone-number-not-recognized message is \"#{@demo.unrecognized_user_message}\"" 
    - else 
      Game will have default phone-number-not-recognized message
   


  %p
    - if @demo.act_too_early_message.present? 
      = "Response to command before game begins is \"#{@demo.act_too_early_message}\"" 
    - else 
      Game will have default response to command before game begins.  
  


  %p
    - if @demo.act_too_late_message.present? 
      = "Response to command after game ends is \"#{@demo.act_too_late_message}\"" 
    - else 
      Game will have default response to command after game ends.  
   


  %p
    - if @demo.survey_answer_activity_message.present? 
      = "Activity feed text when user answers a survey question is \"#{@demo.survey_answer_activity_message}\"" 
    - else 
      Game will have default activity feed text when user answers a survey question  
   
  %p
    - if @demo.custom_already_claimed_message.present?
      = %{Custom already-claimed message is "#{@demo.custom_already_claimed_message}"}
    - else
      Game will have default already-claimed message

  %p
    - if @demo.login_announcement.present? 
      = "Message user sees on login is \"#{@demo.login_announcement}\"" 
    - else 
      User sees no custom message on login
   


  %p
    - if @demo.mute_notice_threshold 
      Mute notice to users after 
      = @demo.mute_notice_threshold  
      SMSes
    - else 
      Game will have default mute notice threshold

  %p
    - if @demo.custom_support_reply.present?
      = %{Custom support reply is "#{@demo.custom_support_reply}"}
    - else
      No custom support reply.

  %p
    - if @demo.use_post_act_summaries
      Post-act summaries will be sent
    - else
      No post-act summaries will be sent

  %p
    - if @demo.example_tutorial
      Custom example for slide 1 of tutorial:
      = @demo.example_tutorial  
    - else 
      Game will have default tutorial example
   
  %p
    - if @demo.example_tooltip
      Custom example for Playbox tooltip:
      = @demo.example_tooltip
    - else 
      Game will have default tooltip example

  %p 
    = "Game will#{' not' unless @demo.uses_gold_coins} use gold coins"
    -if @demo.uses_gold_coins
      %p= "Gold coins are awarded every #{@demo.gold_coin_threshold} points (#{@demo.minimum_gold_coin_award} to #{@demo.maximum_gold_coin_award} coins awarded at a time)"

  %p
    - unless @demo.internal_domains.empty?
      Internal email domains are:
      %ul
        -@demo.internal_domains.each do |internal_domain|
          %li=internal_domain

    - else
      No email domains will be considered internal.

  %p.explanation= translate('.explanation', :default => "Add HR people from %{company} to this demo, then send them an invitation to the demo.", :company => @demo.name) 


  %h2 Users
  #add-new-user= link_to "Add new user", '#'
  = content_for :javascript do
    :javascript
      $('#add-new-user').click(function(){
        $('#new-user-form').show();
      });
  #new-user-form= render :partial => 'admin/users/new', :locals => { :demo => @demo } 


  = link_to "Bulk load users", new_admin_demo_bulk_load_path(@demo) 

  = render 'user_paginator', :demo => @demo 

  = form_tag admin_demo_path(@demo), :method => :delete do 
    %h2 Destroy game
    %p Destroying a game is <strong>irrevocable</strong>. There is <strong>no undo</strong>. This will also delete <strong>all associated records, including users and their actions</strong>.
    %p If you want to save users from this demo, move them to another demo first.
    = submit_tag "Destroy game", :confirm => "Really destroy this \"#{@demo.name}\" game?" 
 
