<%= form_tag new_game_path, method: :get do |f| %>
  <ul>
    <% name_field_css_class = "customer-name signup-field" %>
    <% email_field_css_class = "customer-email signup-field" %>

    <% if flash[:show_sign_up_form_error] %>
      <% name_field_css_class += " unfilled-field" if flash[:customer_name].blank? %>
      <% email_field_css_class += " unfilled-field" if flash[:customer_email].blank? %>

      <% unless @error_already_tracked %>
        <%= mp_track "returned to marketing page because of signup form error" %>
      <% end %>
      <% @error_already_tracked = true %>
    <% end %>

    <%= text_field_tag "customer_name", flash[:customer_name], class: name_field_css_class, placeholder: "First and last name" %>
    <%= text_field_tag "customer_email", flash[:customer_email], class: email_field_css_class, placeholder: "Email" %>
    <li><input type="submit" value="Start a game" class="start-game-button"/><p>14 day free trial</p></li>
  </ul>
<% end %>

<% if flash[:show_sign_up_form_error] %>
  <div id="sign_up_form_error">Please enter both your name and an e-mail address.</div>
<% end %>

<div class="log-in-elsewhere">
  Already playing? <%= link_to "Log in here", sign_in_path %>
</div>

<%= javascript_tag do %>
  $('.signup-field').blur(function(e) {
    var field = $(e.target);
    
    var isBlank = ($.trim(field.val()) == '');

    field.toggleClass('unfilled-field', isBlank);
  })

  $('.log-in-elsewhere a').click(function(e) {
    mpq.track("clicked alternate user login link", {});
  });
<% end %>
