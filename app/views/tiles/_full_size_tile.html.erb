<% creator_class = tile.appears_client_created ? 'client_created' : 'admin_created' %>
<% overlay_displayed ||= false %>
<% show_copy_button ||= false %>
<% is_preview ||= false %>

<% tile = FullSizeTilePresenter.new(tile, current_user, is_preview, @current_tile_ids) %>

<div class="tile_holder <%= creator_class %>" 
  data-current-tile-id="<%= tile.id %>" 
  data-completed-only="<%= @show_completed_tiles %>" 
  data-show-conversion-form="<%= @show_conversion_form||false %>" 
  data-show-start-over="<%= session[:display_start_over_button] %>" 
  data-current-tile-ids="<%= tile.current_tile_ids_joined %>">

  <div class="<%=tile_class(tile)%>">
    <div class="tile_full_image">
      <%= image_tag tile.image.url, :class => :tile_image, :alt => tile.headline, style: "height:#{tile.full_size_image_height}px;" %>
      <div class="shadow_overlay"></div>
      <div class="image_credit">
        <div class="image_credit_view">
          <%= link_to_if is_url?(tile.image_credit), truncate(tile.image_credit, length: 50), make_full_url(tile.image_credit), target: "_blank" %>
        </div>
      </div>
    </div>

    <% if tile.appears_client_created %>
      <div class="tile_texts_container">
        <div class="tile_headline"><%= tile.headline %></div>
        <div class="tile_supporting_content"><%= tile.supporting_content %></div>
        <% if tile.link_address.present? %>
          <div class="tile_external_link">
            Visit <%= link_to truncate(tile.link_address, length: 30), tile.link_address, target: '_blank' %> <%= link_to fa_icon("external-link"), tile.link_address, target: '_blank' %>
          </div>
        <% end %>

        <div class="tile_quiz">
          <% if tile.points %>
            <div class="tile_points_bar">
              <div class="earnable_points">
                <span class="num_of_points" id="tile_point_value"><%= tile.points %></span>
                <span class="points_label"><%= tile.points > 1 ? "Points" : "Point" %></span>
              </div>
            </div>
          <% end %>


          <div class="tile_question"><%= tile.question %></div>
          <%= render 'tiles/multiple_choice_answers', tile: tile %>
        </div>
      </div>
    <% end %>

    <% overlay_style = overlay_displayed ? "display:block" : "" %>
    <div id="spinner_large" style="<%= overlay_style %>">
    </div>
  </div>
</div>

<%= render 'tiles/copy_button', tile: tile if show_copy_button%>

<% tile.adjacent_tile_image_urls.each do |adjacent_tile_image_url| %>
  <%= javascript_tag do %>
    $(document).ready(function() { preflight("<%= adjacent_tile_image_url %>"); });
  <% end %>
<% end %>
