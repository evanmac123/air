<div class="container">
	<div class="module about_user">
		<h1 class="headline">User information</h1>
    <div class="module_inner settings_avatar">
        <h2 class="title">Change your avatar</h2>
        <%= avatar_96 current_user %>
        <div class="avatar_inputs">
          <%= form_for current_user, :url => account_avatar_path, :html => {:multipart => true, :class => 'set-avatar'} do |form| %>
            <%= form.file_field :avatar, :id => "avatar_path" %> 
            <%= form.submit "Upload", :class => "button_norm" %>
          <% end %>
          <% if current_user.avatar_file_name %>
            <%= form_for current_user, :url => account_avatar_path, :html => {:multipart => true, :method => :delete, :class => 'clear-avatar'} do |form| %>
              <%= form.submit "Clear", :class => "button_norm" %>
            <% end %>
          <% end %>
        </div>
        <div class="cf"></div>
    </div>

    <%= form_for current_user, :url => account_settings_path, :html => {id: :username_dob_gender} do |form| %>
      <div class="module_inner settings_user">
        <h2 class="title">Username</h2>
        <%= label_tag "user[sms_slug]", "Change your username." %>
        <%= form.text_field "sms_slug" %>
      </div>

      <div class="module_inner settings_dob">
        <h2 class="title"><%= label_tag 'user_date_of_birth', "Date of Birth" %></h2>
        <%= form.text_field :date_of_birth, :value => current_user.date_of_birth.try(:as_pretty_date) %>
      </div>
      <div class="module_inner settings_gender">
        <h2 class="title">Gender</h2>
        <ul>
          <% %w(male female other).each do |gender_value| %>
            <li><%= form.radio_button "gender", gender_value, :id => gender_value %><%= label_tag gender_value %></li>
          <% end %>
        </ul>
      </div>

      <%= form.submit 'Save', :class => "button_norm" %>
    <% end %>

		<div class="cf"></div>
  </div>

  <div class="module other_settings privacy_settings">
    <h1 class="headline">Privacy Preferences</h1>
      <%= form_for current_user, :url => account_settings_path do |form| %>
        <div class="module_inner">
          <h2 class="title"><%= label_tag "user_privacy_level", "Let these people see my actions:" %></h2>
          <%= form.select :privacy_level, [
            ['Everybody', 'everybody'],
            ["Friends I've accepted", 'connected']
          ] %>
        </div>
        <%= submit_tag 'Save', :class => 'button_norm', :id => 'save-privacy-level' %>
      <% end %>
  </div>

	<div class="module other_settings notification_settings">
    <h1 class="headline">Notification Preferences</h1>
    <% if current_user.new_phone_number_needs_verification? %>
      <div class="module_inner settings_new_number_verification">
        <%= form_for current_user, :url => phone_path, :method => :put do |form| %>
          <h2 class="title"><%= label_tag "user_new_phone_validation", "To verify the number #{current_user.new_phone_number.as_pretty_phone}, please enter the validation code we sent to that number:" %></h2>
          <%= form.text_field :new_phone_validation, :value => '' %>
          <%= submit_tag 'Verify New Number', :class => 'button_norm' %>
        <% end %>
      </div>
    <% end %>
    <%= form_for current_user, :url => account_path do |form| %>
      <div class="module_inner settings_number">
        <h2 class="title"><%= label_tag 'user_phone_number', "Mobile Number" %></h2>
        <%= form.text_field :phone_number, :value => current_user.phone_number.try(:as_pretty_phone) %>
      </div>
      <div class="module_inner settings_notification">
        <h2 class="title">Notify me via...</h2>
          <ul>
            <% [["SMS/text message", :sms], ["Email", :email], ["Both", :both] ].each do |label_text, method_name| %>
              <li><%= form.radio_button :notification_method, method_name, :class => 'notification_pref', :id => method_name %><%= label_tag method_name, label_text, :class => 'check_label' %></li>
            <% end %>
          </ul>
      </div>
      <%= submit_tag 'Save', :class => 'button_norm', :id => 'save-notification-settings' %>
    <% end %>
	</div>
	<div class="module other_settings password_change">
    <h1 class="headline">Change Password</h1>
    <%= form_for current_user, :url => logged_in_user_password_path do |form| %>
      <div class="module_inner settings_new_password">
        <h2 class="title"><%= label_tag 'user_password', "New password" %></h2>
        <%= form.password_field :password %>
        <h2 class="title"><%= label_tag 'user_password_confirmation', "Confirm new password" %></h2>
        <%= form.password_field :password_confirmation %>
      </div>
      <%= submit_tag 'Save new password', :class => 'button_norm', :id => 'save-notification-settings' %>
    <% end %>
  </div>	
  <div class="cf"></div>
</div>
<% content_for :javascript do %>
  <%= mp_track_page 'settings' %>
<% end %>
